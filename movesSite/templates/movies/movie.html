{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-md-6 offset-md-3">
        
        <!-- Заголовок -->
        {% if view.object %}
            {% if view.view_name == 'movies:delete' %}
                <h2 class="mb-4 text-danger">Удалить фильм</h2>
            {% else %}
                <h2 class="mb-4">Изменить фильм</h2>
            {% endif %}
        {% else %}
            <h2 class="mb-4">Добавить фильм</h2>
        {% endif %}

        <!-- Форма для создания/редактирования -->
        {% if view.view_name != 'movies:delete' %}
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="mb-3">
                <label class="form-label">Название *</label>
                <input type="text" name="title" value="{{ form.title.value|default:'' }}" 
                       class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Режиссёр *</label>
                <input type="text" name="director" value="{{ form.director.value|default:'' }}" 
                       class="form-control" required>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label class="form-label">Год выпуска *</label>
                    <input type="number" name="release_year" value="{{ form.release_year.value|default:'' }}" 
                           class="form-control" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label class="form-label">Жанр</label>
                    <input type="text" name="genre" value="{{ form.genre.value|default:'' }}" 
                           class="form-control">
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">Описание</label>
                <textarea name="description" class="form-control" rows="3">{{ form.description.value|default:'' }}</textarea>
            </div>

            <div class="mb-4">
                <label class="form-label">Постер</label>
                <input type="file" name="poster" class="form-control">
                {% if form.instance.poster %}
                    <small>Текущий: {{ form.instance.poster.name }}</small>
                {% endif %}
            </div>

            <div class="d-flex justify-content-between">
                <a href="{% url 'movies:list' %}" class="btn btn-secondary">
                    Назад
                </a>
                <button type="submit" class="btn btn-primary">
                    {% if view.object %}Сохранить{% else %}Добавить{% endif %}
                </button>
            </div>
        </form>
        
        <!-- Блок для удаления -->
        {% else %}
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">{{ object.title }}</h5>
                <p class="card-text">
                    <strong>Режиссёр:</strong> {{ object.director }}<br>
                    <strong>Год:</strong> {{ object.release_year }}<br>
                    {% if object.genre %}<strong>Жанр:</strong> {{ object.genre }}{% endif %}
                </p>
                <p class="text-danger">
                    Вы уверены, что хотите удалить этот фильм?
                </p>
            </div>
        </div>

        <form method="post">
            {% csrf_token %}
            <div class="d-flex justify-content-between">
                <a href="{% url 'movies:list' %}" class="btn btn-secondary">
                    Отмена
                </a>
                <button type="submit" class="btn btn-danger">
                    Удалить
                </button>
            </div>
        </form>
        {% endif %}

    </div>
</div>
{% endblock %}